# Render Blueprint for Django Application
# Reference: https://render.com/docs/blueprint-spec

services:
  - type: web
    name: schoolmap
    env: python
    runtime: python3.10.10
    buildCommand: |
      pip install -r requirements.txt
      python manage.py collectstatic --noinput
      python manage.py migrate
    startCommand: gunicorn schoolmap.wsgi:application
    envVars:
      - key: PYTHON_VERSION
        value: 3.10.10
      - key: DISABLE_COLLECTSTATIC
        value: 0
      - key: DJANGO_SETTINGS_MODULE
        value: schoolmap.settings
      - key: SECRET_KEY
        generateValue: true
      - key: WEB_CONCURRENCY
        value: 4
      - key: DEBUG
        value: 'False'
      - key: ALLOWED_HOSTS
        value: '${RENDER_EXTERNAL_HOSTNAME} .onrender.com'
      
      # Database (PostgreSQL on Render)
databases:
  - name: schoolmap-db
    databaseName: schoolmap
    user: schoolmap_user
    plan: free
      
      # Cloudinary Configuration (update these with your actual credentials)
      - key: CLOUDINARY_CLOUD_NAME
        value: your_cloud_name_here
      - key: CLOUDINARY_API_KEY
        value: your_api_key_here
      - key: CLOUDINARY_API_SECRET
        value: your_api_secret_here
      - key: USE_CLOUDINARY
        value: 'True'
      
      # Email Configuration (update with your email provider details)
      - key: EMAIL_BACKEND
        value: 'django.core.mail.backends.smtp.EmailBackend'
      - key: EMAIL_HOST
        value: 'smtp.sendgrid.net'
      - key: EMAIL_PORT
        value: '587'
      - key: EMAIL_USE_TLS
        value: 'True'
      - key: DEFAULT_FROM_EMAIL
        value: 'noreply@yourdomain.com'
      - key: SENDGRID_API_KEY
        value: your_sendgrid_api_key_here

    plan: free
    numInstances: 1
    healthCheckPath: /
    autoDeploy: true
    region: oregon

# Uncomment and configure if you need a database
# databases:
#   - name: schoolmap-db
#     databaseName: schoolmap
#     user: schoolmap_user
#     plan: free  # or 'starter' or 'standard' for production
